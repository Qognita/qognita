@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 221.2 83.2% 53.3%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 222.2 84% 4.9%;
    --muted: 210 40% 96%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96%;
    --accent-foreground: 222.2 84% 4.9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 221.2 83.2% 53.3%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 217.2 91.2% 59.8%;
    --primary-foreground: 222.2 84% 4.9%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 224.3 76.3% 94.1%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html,
  body {
    @apply bg-background text-foreground;
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }

  /* Fix backdrop-filter compatibility */
  .backdrop-blur-sm {
    -webkit-backdrop-filter: blur(4px);
    backdrop-filter: blur(4px);
  }

  /* Smooth scrolling */
  html {
    scroll-behavior: smooth;
  }
}

/* World-Class Markdown Styling */
@layer components {
  .markdown-content {
    @apply w-full text-base leading-relaxed;
    max-width: 100%;
  }

  .markdown-content h1 {
    @apply mb-6 mt-0 border-b-2 border-blue-500/40 pb-4 text-3xl font-bold text-white;
    line-height: 1.2;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    background: linear-gradient(135deg, #ffffff, #e5e7eb);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    position: relative;
  }

  .markdown-content h1::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 60px;
    height: 3px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    border-radius: 2px;
  }

  .markdown-content h2 {
    @apply mb-4 mt-6 text-2xl font-bold text-white;
    line-height: 1.3;
    position: relative;
    padding-left: 1rem;
  }

  .markdown-content h2::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    height: 24px;
    background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    border-radius: 2px;
  }

  .markdown-content h3 {
    @apply mb-3 mt-5 text-xl font-semibold text-blue-200;
    line-height: 1.4;
    position: relative;
    padding-left: 0.75rem;
  }

  .markdown-content h3::before {
    content: '▶';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    color: #60a5fa;
    font-size: 0.8em;
  }

  .markdown-content h4 {
    @apply mb-3 mt-4 text-lg font-semibold text-blue-300;
    position: relative;
  }

  .markdown-content h5 {
    @apply mb-2 mt-3 text-base font-semibold text-blue-400;
  }

  .markdown-content h6 {
    @apply mb-2 mt-3 text-sm font-semibold text-gray-300;
  }

  .markdown-content p {
    @apply mb-4 leading-8 text-gray-100;
    font-size: 1rem;
    letter-spacing: 0.01em;
  }

  .markdown-content>p:first-child {
    @apply mt-0;
  }

  .markdown-content a {
    @apply text-blue-400 underline decoration-blue-400/50 transition-colors hover:text-blue-300 hover:decoration-blue-300;
    text-underline-offset: 3px;
  }

  .markdown-content strong {
    @apply font-bold text-white;
  }

  .markdown-content em {
    @apply italic text-gray-200;
  }

  .markdown-content ul {
    @apply mb-4 ml-6 list-disc space-y-2;
  }

  .markdown-content ol {
    @apply mb-4 ml-6 list-decimal space-y-2;
  }

  .markdown-content li {
    @apply leading-7 text-gray-100;
    padding-left: 0.5rem;
  }

  .markdown-content li::marker {
    @apply text-blue-400;
  }

  .markdown-content ul ul,
  .markdown-content ol ol {
    @apply mb-2 mt-2;
  }

  .markdown-content code {
    @apply rounded-md border border-gray-700/50 bg-gray-800/90 px-2 py-1 font-mono text-sm text-green-400 shadow-sm;
    font-weight: 500;
    letter-spacing: 0.025em;
  }

  .markdown-content pre {
    @apply mb-6 overflow-x-auto rounded-xl border border-gray-700/50 bg-gray-900/95 p-6 shadow-2xl;
    position: relative;
    backdrop-filter: blur(10px);
  }

  .markdown-content pre::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, #3b82f6, transparent);
  }

  .markdown-content pre code {
    @apply border-0 bg-transparent px-0 py-0 text-sm text-green-400;
    display: block;
    line-height: 1.7;
    font-weight: 400;
    letter-spacing: 0.01em;
  }

  /* Code block language indicator */
  .markdown-content pre[data-language]::after {
    content: attr(data-language);
    @apply absolute right-4 top-3 rounded bg-gray-800/80 px-2 py-1 text-xs text-gray-400 uppercase tracking-wide;
    font-family: ui-sans-serif, system-ui, -apple-system, sans-serif;
    font-weight: 600;
    letter-spacing: 0.05em;
  }

  /* Line numbers for code blocks */
  .markdown-content pre code {
    counter-reset: line-numbering;
  }

  .markdown-content pre code .line {
    counter-increment: line-numbering;
    position: relative;
    padding-left: 3rem;
  }

  .markdown-content pre code .line::before {
    content: counter(line-numbering);
    position: absolute;
    left: 0;
    top: 0;
    @apply text-gray-600 text-xs font-mono;
    width: 2.5rem;
    text-align: right;
    padding-right: 1rem;
    user-select: none;
  }

  .markdown-content blockquote {
    @apply my-6 rounded-r-lg border-l-4 border-blue-500 bg-gradient-to-r from-gray-800/40 to-gray-800/20 py-4 pl-6 italic text-gray-200 shadow-lg;
    position: relative;
    backdrop-filter: blur(5px);
  }

  .markdown-content blockquote::before {
    content: '"';
    position: absolute;
    top: -0.5rem;
    left: 1rem;
    font-size: 3rem;
    color: #3b82f6;
    opacity: 0.3;
    font-family: serif;
    line-height: 1;
  }

  .markdown-content blockquote p {
    @apply mb-2 last:mb-0 text-base leading-relaxed;
    position: relative;
    z-index: 1;
  }

  .markdown-content blockquote p:last-child::after {
    content: '"';
    font-size: 1.5rem;
    color: #3b82f6;
    opacity: 0.3;
    font-family: serif;
  }

  .markdown-content hr {
    @apply my-6 border-t border-gray-600;
  }

  .markdown-content table {
    @apply mb-6 w-full border-collapse overflow-hidden rounded-xl shadow-2xl;
    border-spacing: 0;
    font-size: 0.95rem;
    min-width: 100%;
    table-layout: auto;
    border: 1px solid rgba(59, 130, 246, 0.2);
    backdrop-filter: blur(10px);
  }

  .markdown-content thead {
    @apply bg-gradient-to-r from-blue-900/80 via-indigo-900/70 to-purple-900/80 backdrop-blur-md;
    position: relative;
  }

  .markdown-content thead::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6, #06b6d4);
  }

  .markdown-content th {
    @apply border-b-2 border-blue-500/40 px-4 py-3 text-left text-sm font-bold text-white;
    border-right: 1px solid rgba(59, 130, 246, 0.15);
    white-space: nowrap;
    letter-spacing: 0.025em;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    position: relative;
  }

  .markdown-content th:last-child {
    border-right: none;
  }

  .markdown-content th::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .markdown-content th:hover::before {
    opacity: 1;
  }

  .markdown-content td {
    @apply border-b border-gray-700/40 px-4 py-3 text-sm text-gray-100;
    border-right: 1px solid rgba(75, 85, 99, 0.15);
    transition: all 0.2s ease;
    position: relative;
  }

  .markdown-content td:last-child {
    border-right: none;
  }

  .markdown-content tbody tr {
    @apply transition-all duration-200 ease-out;
  }

  .markdown-content tbody tr:nth-child(even) {
    @apply bg-gradient-to-r from-gray-800/15 to-gray-800/25;
  }

  .markdown-content tbody tr:hover {
    @apply scale-[1.005] bg-gradient-to-r from-blue-900/25 to-indigo-900/25;
    transform-origin: center;
    box-shadow: 0 4px 20px rgba(59, 130, 246, 0.15);
  }

  .markdown-content tbody tr:last-child td {
    border-bottom: none;
  }

  /* Enhanced cell content styling */
  .markdown-content td strong,
  .markdown-content th strong {
    @apply text-white font-semibold;
  }

  .markdown-content td code,
  .markdown-content th code {
    @apply bg-gray-800/60 px-2 py-1 rounded text-green-400 font-mono text-xs;
    border: 1px solid rgba(34, 197, 94, 0.2);
  }

  /* Numeric cells */
  .markdown-content td:has(> *:is(code, [data-numeric="true"])) {
    @apply font-mono text-right;
  }

  /* Status indicators in tables */
  .markdown-content td:contains('✅'),
  .markdown-content td:contains('Success') {
    @apply text-green-400 bg-green-900/20;
  }

  .markdown-content td:contains('❌'),
  .markdown-content td:contains('Error') {
    @apply text-red-400 bg-red-900/20;
  }

  .markdown-content td:contains('⚠️'),
  .markdown-content td:contains('Warning') {
    @apply text-yellow-400 bg-yellow-900/20;
  }

  /* Currency and amount styling */
  .markdown-content td:contains('$'),
  .markdown-content td:contains('USD') {
    @apply font-mono font-semibold text-green-300;
  }

  .markdown-content img {
    @apply my-4 h-auto max-w-full rounded-lg shadow-md;
  }

  .markdown-content kbd {
    @apply rounded border border-gray-600 bg-gray-700 px-2 py-1 font-mono text-xs shadow-sm;
  }

  .markdown-content mark {
    @apply rounded bg-yellow-500/30 px-1 text-yellow-200;
  }

  /* Code syntax highlighting classes */
  .markdown-content .token.comment,
  .markdown-content .token.prolog,
  .markdown-content .token.doctype,
  .markdown-content .token.cdata {
    @apply italic text-gray-500;
  }

  .markdown-content .token.punctuation {
    @apply text-gray-400;
  }

  .markdown-content .token.property,
  .markdown-content .token.tag,
  .markdown-content .token.boolean,
  .markdown-content .token.number,
  .markdown-content .token.constant,
  .markdown-content .token.symbol {
    @apply text-cyan-400;
  }

  .markdown-content .token.selector,
  .markdown-content .token.attr-name,
  .markdown-content .token.string,
  .markdown-content .token.char,
  .markdown-content .token.builtin {
    @apply text-green-400;
  }

  .markdown-content .token.operator,
  .markdown-content .token.entity,
  .markdown-content .token.url,
  .markdown-content .token.variable {
    @apply text-yellow-400;
  }

  .markdown-content .token.atrule,
  .markdown-content .token.attr-value,
  .markdown-content .token.function,
  .markdown-content .token.class-name {
    @apply text-blue-400;
  }

  .markdown-content .token.keyword {
    @apply text-purple-400;
  }

  .markdown-content .token.regex,
  .markdown-content .token.important {
    @apply text-orange-400;
  }

  /* Scrollbar styling for code blocks */
  .markdown-content pre::-webkit-scrollbar {
    @apply h-2;
  }

  .markdown-content pre::-webkit-scrollbar-track {
    @apply rounded bg-gray-800;
  }

  .markdown-content pre::-webkit-scrollbar-thumb {
    @apply rounded bg-gray-600 hover:bg-gray-500;
  }

  /* Enhanced heading styles with gradients */
  .markdown-content h2::before {
    content: '';
    @apply mr-2 inline-block h-6 w-1 bg-gradient-to-b from-blue-500 to-purple-500;
  }

  /* Special status indicators */
  .markdown-content td:has(> :is(.success, [aria-label*='Success'])),
  .markdown-content td:contains('✅') {
    @apply text-green-400;
  }

  .markdown-content td:has(> :is(.error, [aria-label*='Error'])),
  .markdown-content td:contains('❌') {
    @apply text-red-400;
  }

  .markdown-content td:has(> :is(.warning, [aria-label*='Warning'])),
  .markdown-content td:contains('⚠️') {
    @apply text-yellow-400;
  }

  /* Numeric column styling */
  .markdown-content td:nth-child(n):has(> :is(code, [data-type='number'])) {
    @apply font-mono;
  }

  /* Responsive table wrapper */
  .markdown-content {
    @apply w-full;
  }

  .markdown-content table {
    @apply min-w-full;
  }

  /* Mobile responsive tables */
  @media (max-width: 768px) {
    .markdown-content table {
      @apply text-sm;
      font-size: 0.8rem;
    }

    .markdown-content th,
    .markdown-content td {
      @apply px-2 py-2;
    }

    .markdown-content pre {
      @apply p-3 text-xs;
    }

    .markdown-content h1 {
      @apply text-2xl;
    }

    .markdown-content h2 {
      @apply text-xl;
    }

    .markdown-content h3 {
      @apply text-lg;
    }

    .markdown-content p {
      @apply text-sm leading-6;
    }
  }

  /* Tablet responsive */
  @media (max-width: 1024px) and (min-width: 769px) {
    .markdown-content table {
      @apply text-sm;
    }

    .markdown-content th,
    .markdown-content td {
      @apply px-3 py-2;
    }
  }

  /* Code block improvements */
  .markdown-content pre {
    @apply relative;
  }

  .markdown-content pre::before {
    content: 'code';
    @apply absolute right-2 top-2 rounded bg-gray-800/80 px-2 py-1 text-xs text-gray-400;
  }

  /* Inline code with better contrast */
  .markdown-content code {
    @apply shadow-sm;
  }

  /* Link hover effects */
  .markdown-content a:hover {
    @apply bg-blue-500/10;
    border-radius: 3px;
    padding: 0 2px;
  }

  /* Blockquote with icon */
  .markdown-content blockquote {
    @apply relative;
  }

  .markdown-content blockquote::before {
    content: '💡';
    @apply absolute -left-1 top-2 text-lg;
  }

  /* Enhanced list styling */
  .markdown-content ul li,
  .markdown-content ol li {
    @apply relative pl-2;
  }

  .markdown-content ul li:hover,
  .markdown-content ol li:hover {
    @apply translate-x-1 transition-transform;
  }

  /* Horizontal rule styling */
  .markdown-content hr {
    @apply bg-gradient-to-r from-transparent via-blue-500/50 to-transparent;
    height: 2px;
  }

  /* Better spacing for nested elements */
  .markdown-content>*:first-child {
    @apply mt-0;
  }

  .markdown-content>*:last-child {
    @apply mb-0;
  }

  /* Emoji sizing */
  .markdown-content h1 :is(emoji, [role='img']),
  .markdown-content h2 :is(emoji, [role='img']),
  .markdown-content h3 :is(emoji, [role='img']) {
    @apply inline-block;
    font-size: 1.2em;
  }

  /* Table cell alignment helpers */
  .markdown-content td:has(> :is(code)),
  .markdown-content th:has(> :is(code)) {
    @apply font-mono text-sm;
  }

  /* Smooth animations */
  .markdown-content table,
  .markdown-content pre,
  .markdown-content blockquote {
    @apply transition-all duration-200;
  }

  /* Focus states for accessibility */
  .markdown-content a:focus,
  .markdown-content button:focus {
    @apply outline-2 outline-offset-2 outline-blue-500;
  }

  /* Data visualization styles */
  .markdown-content .data-highlight {
    @apply rounded bg-gradient-to-r from-blue-500/20 to-purple-500/20 px-2 py-1 font-semibold;
  }

  .markdown-content .metric-card {
    @apply rounded-lg border border-blue-500/30 bg-gradient-to-br from-blue-900/30 to-purple-900/30 p-4 shadow-lg;
    backdrop-filter: blur(10px);
  }

  .markdown-content .status-badge {
    @apply inline-flex items-center rounded-full px-3 py-1 text-xs font-medium;
  }

  .markdown-content .status-success {
    @apply bg-green-900/50 text-green-400 border border-green-500/30;
  }

  .markdown-content .status-warning {
    @apply bg-yellow-900/50 text-yellow-400 border border-yellow-500/30;
  }

  .markdown-content .status-error {
    @apply bg-red-900/50 text-red-400 border border-red-500/30;
  }

  .markdown-content .status-info {
    @apply bg-blue-900/50 text-blue-400 border border-blue-500/30;
  }

  /* Interactive elements */
  .markdown-content .collapsible {
    @apply cursor-pointer transition-all duration-200;
  }

  .markdown-content .collapsible:hover {
    @apply bg-gray-800/30 rounded;
  }

  .markdown-content .tooltip {
    @apply relative inline-block;
  }

  .markdown-content .tooltip:hover::after {
    content: attr(data-tooltip);
    @apply absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 text-xs text-white bg-gray-900 rounded shadow-lg whitespace-nowrap z-10;
  }

  /* Progress bars and charts */
  .markdown-content .progress-bar {
    @apply w-full bg-gray-700 rounded-full h-2 overflow-hidden;
  }

  .markdown-content .progress-fill {
    @apply h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-500 ease-out;
  }

  .markdown-content .chart-container {
    @apply rounded-lg border border-gray-700/50 bg-gray-900/50 p-4 shadow-lg;
  }

  /* Enhanced list styling */
  .markdown-content ul li::marker {
    @apply text-blue-400;
    content: '▸ ';
  }

  .markdown-content ol li::marker {
    @apply text-blue-400 font-bold;
  }

  /* Improved spacing and layout */
  .markdown-content>*+* {
    @apply mt-4;
  }

  .markdown-content h1+*,
  .markdown-content h2+*,
  .markdown-content h3+*,
  .markdown-content h4+*,
  .markdown-content h5+*,
  .markdown-content h6+* {
    @apply mt-3;
  }

  /* Enhanced image styling */
  .markdown-content img {
    @apply my-6 h-auto max-w-full rounded-xl shadow-xl border border-gray-700/50;
    transition: transform 0.2s ease;
  }

  .markdown-content img:hover {
    @apply scale-105;
  }

  /* Loading states */
  .markdown-content .loading {
    @apply animate-pulse bg-gray-700/50 rounded;
  }

  /* Success/Error message styling */
  .markdown-content .alert {
    @apply rounded-lg border-l-4 p-4 mb-4;
  }

  .markdown-content .alert-success {
    @apply bg-green-900/20 border-green-500 text-green-400;
  }

  .markdown-content .alert-error {
    @apply bg-red-900/20 border-red-500 text-red-400;
  }

  .markdown-content .alert-warning {
    @apply bg-yellow-900/20 border-yellow-500 text-yellow-400;
  }

  .markdown-content .alert-info {
    @apply bg-blue-900/20 border-blue-500 text-blue-400;
  }
}

/* Loading animation for markdown content */
@keyframes markdown-fade-in {
  from {
    opacity: 0;
    transform: translateY(10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.markdown-content {
  animation: markdown-fade-in 0.3s ease-out;
}